<!-- Navigation -->
<header class="bg-white/90 backdrop-blur-md sticky top-0 z-30 shadow-sm">
    <nav class="px-4 h-14 flex justify-between items-center">
        <!-- Logo -->
        <a href="/" class="sm:ml-4 overflow-hidden sm:w-35 w-20">
            <img src="/images/baglogo.png" alt="" class="rounded-2xl ">
        </a>


        <!-- Desktop Navigation Links and Search -->
        <div class="hidden lg:flex items-center space-x-6">
            <!-- Category Dropdown -->
            <div class="relative group">
                <button
                    class="flex items-center text-gray-800 hover:text-orange-600 transition font-semibold text-sm uppercase">
                    Shop By Category
                    <svg class="w-4 h-4 ml-1 group-hover:rotate-180" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </button>
                <div
                    class="absolute hidden group-hover:flex flex-col bg-white/90 shadow-2xl rounded-xl mt-2 -ml-5 w-50 z-10 opacity-0 group-hover:opacity-100 transform group-hover:-translate-y-1 transition-all duration-300">
                    <a href="/categories/backpacks"
                        class="block px-5 py-4 text-gray-800 hover:bg-gradient-to-r hover:from-orange-50 hover:to-orange-100 hover:text-orange-500 rounded-t-xl text-base font-medium transition-all duration-200">Backpacks</a>
                    <a href="/categories/luggage"
                        class="block px-5 py-4 text-gray-800 hover:bg-gradient-to-r hover:from-orange-50 hover:to-orange-100 hover:text-orange-500 text-base font-medium transition-all duration-200">Luggage</a>
                    <a href="/categories/trolleys"
                        class="block px-5 py-4 text-gray-800 hover:bg-gradient-to-r hover:from-orange-50 hover:to-orange-100 hover:text-orange-500 text-base font-medium transition-all duration-200">Trolley
                        Bags</a>
                    <a href="/categories/duffels"
                        class="block px-5 py-4 text-gray-800 hover:bg-gradient-to-r hover:from-orange-50 hover:to-orange-100 hover:text-orange-500 text-base font-medium transition-all duration-200">Duffel
                        Bags</a>
                    <a href="/categories/laptop-bags"
                        class="block px-5 py-4 text-gray-800 hover:bg-gradient-to-r hover:from-orange-50 hover:to-orange-100 hover:text-orange-500 text-base font-medium transition-all duration-200">Laptop
                        Bags</a>
                    <a href="/categories/school-bags"
                        class="block px-5 py-4 text-gray-800 hover:bg-gradient-to-r hover:from-orange-50 hover:to-orange-100 hover:text-orange-500 rounded-b-xl text-base font-medium transition-all duration-200">School
                        Bags</a>
                </div>
            </div>

            <!-- Other Links -->
            <a href="/products/shop"
                class="text-gray-800 hover:text-orange-600 transition font-semibold text-sm uppercase">All
                Bag</a>
            <a href="/collections/new-arrivals"
                class="text-gray-800 hover:text-orange-600 transition font-semibold text-sm uppercase">New
                Arrivals</a>
            <a href="/collections/best-sellers"
                class="text-gray-800 hover:text-orange-600 transition font-semibold text-sm uppercase">Best
                Sellers</a>
            <a href="/offers"
                class="text-gray-800 hover:text-orange-600 transition font-semibold text-sm uppercase">Offers</a>
        </div>

        <!-- Search Bar -->
        <div class="hidden lg:block relative flex-1 max-w-xs mx-4">
            <input type="text" placeholder="Search for bags..."
                class="w-full pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-600 focus:border-transparent text-sm" />
            <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-500" fill="none"
                stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </div>

        <!-- Icons -->
        <div class="flex items-center space-x-4">
            <!-- Search Icon (Mobile) -->
            <button class="lg:hidden text-gray-800 hover:text-orange-600 transition" onclick="toggleSearch()">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
            </button>

            <!-- User Account -->
            <% if (!authPage && !isLogin) { %>
                <a href="/users/auth/login" class="group relative" title="Account">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                        class="h-6 w-6 text-gray-800 group-hover:text-orange-600 transition">
                        <path
                            d="M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </a>
                <% } %>

                    <!-- Wishlist -->
                    <a href="/wishlists" class="relative group" title="Wishlist">
                        <div
                            class="absolute -top-2 -right-2 bg-orange-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">
                            <%= wishlistCount %>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-gray-800 group-hover:text-orange-600 transition" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                        </svg>
                    </a>

                    <!-- Cart -->
                    <a href="/carts" class="relative group" title="Cart">
                        <div
                            class="absolute -top-2 -right-2 bg-orange-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">
                            <%= cartCount %>
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6 text-gray-800 group-hover:text-orange-600 transition" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                        </svg>
                    </a>

                    <!-- User Profile Pic with Dropdown -->
                    <% if (isLogin) { %>
                        <div class="relative">
                            <button id="profile-btn"
                                class="h-8 w-8 cursor-pointer rounded-full overflow-hidden focus:outline-none focus:ring-2 focus:ring-orange-600 bg-yellow-400"
                                aria-expanded="false" aria-controls="profile-dropdown">
                                <img src="<%= user.picture ? `data:${user.picture.productImageType};base64,${user.picture.toString('base64')}` : '/images/default-user.png' %>"
                                    alt="Profile picture of <%= user?.name %>"
                                    class="h-full w-full object-top object-cover">
                            </button>

                            <div id="profile-dropdown"
                                class="absolute hidden -right-13 sm:-right-7 mt-3 bg-white/90 shadow-lg rounded-lg z-50 min-w-[150px] max-w-[90vw] sm:max-w-[400px]">

                                <!-- User Info -->
                                <div class="flex items-center px-3 py-3 border-b border-gray-300 whitespace-nowrap">
                                    <img src="<%= user.picture ? `data:${user.picture.productImageType};base64,${user.picture.toString('base64')}` : '/images/default-user.png' %>"
                                        alt="Profile picture of <%= user?.name %>"
                                        class="h-8 w-8 rounded-full mr-2 object-cover object-top bg-yellow-400">
                                    <div>
                                        <p id="user-email" class="text-xs font-mono text-gray-800">
                                            <%= user.email %>
                                        </p>
                                    </div>
                                </div>

                                <!-- Menu Links -->
                                <div class="py-2">
                                    <!-- only render when Owner Login -->
                                    <% if (user.isOwner) { %>
                                        <a href="/owners/profile"
                                            class="flex items-center px-4 py-2 text-gray-600 hover:text-orange-600 hover:bg-orange-50 transition-colors duration-200">
                                            <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                            </svg>
                                            Owner-Profile
                                        </a>

                                        <a href="/owners/createProduct"
                                            class="flex items-center px-4 py-2 text-gray-600 hover:text-orange-600 hover:bg-orange-50 transition-colors duration-200">
                                            <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M12 4v16m8-8H4" />
                                            </svg>
                                            Product
                                        </a>
                                        <% } else{ %>
                                            <a href="/users/profile/<%= user.id %>"
                                                class="flex items-center px-4 py-2 text-gray-600 hover:text-orange-600 hover:bg-orange-50 transition-colors duration-200">
                                                <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                                </svg>
                                                Profile
                                            </a>
                                            <% }%>

                                                <form action="/logout" method="POST" class="">
                                                    <button type="submit"
                                                        class="flex items-center w-full cursor-pointer px-4 py-2 text-gray-600 hover:text-orange-600 hover:bg-orange-50 transition-colors duration-200">
                                                        <svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor"
                                                            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                                stroke-width="2"
                                                                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                                        </svg>
                                                        Logout</button>
                                                </form>

                                </div>
                            </div>
                        </div>
                        <% } %>

                            <!-- Hamburger Menu (Mobile) -->
                            <button class="lg:hidden text-gray-800 hover:text-orange-600 transition"
                                onclick="toggleMenu()">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 6h16M4 12h16M4 18h16" />
                                </svg>
                            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="hidden lg:hidden bg-white shadow-lg">
        <div class="px-4 py-2">
            <a href="/products/shop" class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">All
                Bags</a>
            <a href="/categories/backpacks"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Backpacks</a>
            <a href="/categories/luggage"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Luggage</a>
            <a href="/categories/trolleys"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Trolley Bags</a>
            <a href="/categories/duffels"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Duffel Bags</a>
            <a href="/categories/laptop-bags"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Laptop Bags</a>
            <a href="/categories/school-bags"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">School Bags</a>
            <a href="/collections/new-arrivals"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">New Arrivals</a>
            <a href="/collections/best-sellers"
                class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Best Sellers</a>
            <a href="/offers" class="block px-4 py-2 text-gray-800 hover:bg-orange-50 hover:text-orange-600">Offers</a>
        </div>
    </div>

    <!-- Mobile Search -->
    <div id="mobileSearch" class="hidden lg:hidden px-4 py-3 bg-white border-t">
        <div class="relative">
            <input id="searchbar" type="text" name="searchBag" placeholder="Search for bags..."
                class="w-full pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-600 focus:border-transparent text-sm" />
            <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-500" fill="none"
                stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </div>
    </div>
</header>