<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>BagNest – Premium Bag Collections</title>
        <style>
            /* Review Section Css */
            .animate-scroll {
                display: flex;
                animation: scroll 10s linear infinite;
            }

            @keyframes scroll {
                0% {
                    transform: translateX(0);
                }

                100% {
                    transform: translateX(-50%);
                }
            }

            /* Flash message Css */
            @keyframes yoyo-bounce {
                0% {
                    transform: scale(0);
                }

                50% {
                    transform: scale(1.1);
                    /* Slight overshoot for bounce */
                }

                75% {
                    transform: scale(0.95);
                    /* Pull back slightly */
                }

                100% {
                    transform: scale(1);
                    /* Settle in place */
                }
            }

            .yoyo-bounce {
                animation: yoyo-bounce 0.5s ease-in-out forwards;
            }

            .product-card {
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .product-card:hover {
                transform: translateY(-5px);
            }

            .quick-view-btn {
                opacity: 0;
                transition: opacity 0.3s ease;
            }

            .product-card:hover .quick-view-btn {
                opacity: 1;
            }
        </style>
        <link href="/stylesheets/output.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    </head>
    </head>

    <body class="bg-gradient-to-br from-gray-50 to-indigo-50 font-sans">
        <!-- Header -->
        <%- include('partials/header') %>

            <!-- Flash message -->
            <%- include('partials/flashMessage') %>

                <!-- main  -->
                <main>
                    <!-- carousel Section -->
                    <section class="carousel-section overflow-hidden h-[35vh] sm:h-[60vh] md:h-[93vh]" role="region"
                        aria-label="Featured bags carousel">
                        <div class="relative w-full h-full group">
                            <div id="carousel" class="flex h-full w-full transition-transform duration-700 ease-in-out">
                                <!-- Cloned last slide -->
                                <div class="min-w-full flex-shrink-0 h-full w-full flex-none overflow-hidden">
                                    <a href="/bag/<%= carouselData[carouselData.length - 1].id %>"
                                        class="block h-full w-full">
                                        <div
                                            class="relative w-full h-full bg-gradient-to-b from-indigo-50 to-orange-50">
                                            <img src="<%= carouselData[carouselData.length - 1].image %>"
                                                alt="<%= carouselData[carouselData.length - 1].name %>"
                                                class="w-full h-full object-fill lg:object-cover object-center" />
                                            <div
                                                class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 md:p-8 carousel-text">
                                                <h3 class="carousel-title text-2xl md:text-4xl font-bold text-white">
                                                    <%= carouselData[carouselData.length - 1].name %>
                                                </h3>
                                                <p class="carousel-price text-xl md:text-2xl text-orange-300">
                                                    ₹
                                                    <%= carouselData[carouselData.length - 1].price %>
                                                </p>
                                            </div>
                                        </div>
                                    </a>
                                </div>

                                <!-- Original slides -->
                                <% carouselData.slice(0, 5).forEach(function(bag) { %>
                                    <div class="min-w-full flex-shrink-0 h-full w-full flex-none overflow-hidden">
                                        <a href="/bag/<%= bag.id %>" class="block h-full w-full">
                                            <div
                                                class="relative w-full h-full bg-gradient-to-b from-indigo-50 to-orange-50">
                                                <img src="<%= bag.image %>" alt="<%= bag.name %>"
                                                    class="w-full h-full object-fill lg:object-cover object-center" />
                                                <div
                                                    class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 md:p-8 carousel-text">
                                                    <h3
                                                        class="carousel-title text-2xl md:text-4xl font-bold text-white">
                                                        <%= bag.name %>
                                                    </h3>
                                                    <p class="carousel-price text-xl md:text-2xl text-orange-300">
                                                        ₹
                                                        <%= bag.price %>
                                                    </p>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                    <% }); %>

                                        <!-- Cloned first slide -->
                                        <div class="min-w-full flex-shrink-0 h-full w-full flex-none overflow-hidden">
                                            <a href="/bag/<%= carouselData[0].id %>" class="block h-full w-full">
                                                <div
                                                    class="relative w-full h-full bg-gradient-to-b from-indigo-50 to-orange-50">
                                                    <img src="<%= carouselData[0].image %>"
                                                        alt="<%= carouselData[0].name %>"
                                                        class="w-full h-full object-fill lg:object-cover object-center" />
                                                    <div
                                                        class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 md:p-8 carousel-text">
                                                        <h3
                                                            class="carousel-title text-2xl md:text-4xl font-bold text-white">
                                                            <%= carouselData[0].name %>
                                                        </h3>
                                                        <p class="carousel-price text-xl md:text-2xl text-orange-300">
                                                            ₹<%= carouselData[0].price %>
                                                        </p>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                            </div>

                            <!-- Navigation buttons -->
                            <button id="prevBtn"
                                class="absolute top-1/2 left-2 sm:left-4 transform -translate-y-1/2 bg-orange-600 hover:bg-orange-700 text-white rounded-full p-1 lg:p-2 shadow-lg transition-all duration-300 opacity-70 group-hover:opacity-100 z-10"
                                aria-label="Previous slide">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 sm:w-8 sm:h-8" fill="none"
                                    stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 19l-7-7 7-7" />
                                </svg>
                            </button>
                            <button id="nextBtn"
                                class="absolute top-1/2 right-2 sm:right-4 transform -translate-y-1/2 bg-orange-600 hover:bg-orange-700 text-white rounded-full p-1 lg:p-2 shadow-lg transition-all duration-300 opacity-70 group-hover:opacity-100 z-10"
                                aria-label="Next slide">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 sm:w-8 sm:h-8" fill="none"
                                    stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 5l7 7-7 7" />
                                </svg>
                            </button>

                            <!-- Dots -->
                            <div
                                class="absolute bottom-4 sm:bottom-8 left-0 right-0 flex justify-center space-x-3 z-10">
                                <% for (let i=0; i < Math.min(carouselData.length, 5); i++) { %>
                                    <button
                                        class="carousel-dot w-4 h-4 rounded-full bg-orange-300/50 hover:bg-orange-300 transition-all duration-300"
                                        data-index="<%= i %>"></button>
                                    <% } %>
                            </div>
                        </div>

                    </section>

                    <!-- Products Section -->
                    <section id="bags" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                        <div class="text-center mb-12">
                            <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
                                Explore Our Collections
                            </h2>
                            <p class="text-lg sm:text-xl text-gray-600 max-w-2xl mx-auto">
                                Premium bags crafted for style and functionality.
                            </p>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                            <% bags.forEach(function(bag) { %>
                                <div class="group bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 sm:rounded-xl sm:shadow-md sm:hover:shadow-lg sm:transform-none"
                                    role="article" aria-labelledby="bag-<%= bag.id %>-name"
                                    style="perspective: 1000px;">
                                    <div style="background-color: <%= bag.bgColor %>"
                                        class="relative h-64 sm:h-80 overflow-hidden">
                                        <img src="data:<%= bag.productImage.productImageType %>;base64,<%= bag.productImage.toString('base64') %>"
                                            class="w-full h-full object-cover group-hover:scale-102 sm:group-hover:scale-105 transition-transform duration-500"
                                            style="transform: rotateX(0deg) rotateY(0deg);">
                                        <!-- Category Badge -->
                                        <div
                                            class="absolute top-3 right-3 sm:top-2 sm:right-2 bg-orange-600 text-white px-2 sm:px-3 py-1 rounded-full text-xs font-medium">
                                            <%= bag.category %>
                                        </div>
                                        <!-- Discount Tag -->
                                        <% if (bag.discount) { %>
                                            <div
                                                class="absolute hidden sm:block sm:top-2 sm:left-2 bg-green-200 text-green-800 px-2 sm:px-3 py-1 rounded-full text-xs font-medium">
                                                <%= bag.discount %>% OFF
                                            </div>
                                            <% } %>
                                                <!-- Hover Overlay (Large Screens Only) -->
                                                <div class="absolute inset-0 bg-black/70 opacity-0 group-hover:opacity-100 transition-opacity duration-300 hidden sm:flex flex-col justify-end p-6"
                                                    aria-hidden="true">
                                                    <!-- Stock Badge -->
                                                    <% if(bag.stock> 0 && bag.stock < 10) { %>
                                                            <div
                                                                class="absolute top-2 left-2 bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-xs">
                                                                Only <%= bag.stock %> left
                                                            </div>
                                                            <% }else if(bag.stock <=0){ %>
                                                                <div
                                                                    class="absolute top-2 left-2 bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-xs font-bold">
                                                                    Sold Out
                                                                </div>
                                                                <%}%>

                                                                    <h3 id="bag-<%= bag.id %>-name"
                                                                        class="text-lg font-bold text-white mb-2">
                                                                        <%= bag.productName %>
                                                                    </h3>
                                                                    <p class="text-sm text-gray-200 mb-3 line-clamp-2">
                                                                        <%= bag.description %>
                                                                    </p>
                                                                    <!-- price -->
                                                                    <div class="flex items-center mb-3">
                                                                        <span class="text-xl font-bold text-orange-400">
                                                                            ₹<%= (bag.discount) ? Math.round(bag.price *
                                                                                (1 - bag.discount /
                                                                                100)).toLocaleString('en-IN') :
                                                                                bag.price.toLocaleString('en-IN') %>
                                                                        </span>
                                                                        <% if (bag.discount) { %>
                                                                            <span
                                                                                class="ml-2 text-sm text-gray-300 line-through">
                                                                                ₹<%= bag.price.toLocaleString('en-IN')
                                                                                    %>
                                                                            </span>
                                                                            <% } %>
                                                                    </div>
                                                                    <!-- Rating -->
                                                                    <% if (bag.ratings && bag.ratings> 0 && bag.ratings
                                                                        <= 5) { %>
                                                                            <div class="flex items-center space-x-1 mb-2"
                                                                                aria-label="Rating <%= bag.ratings %> out of 5">
                                                                                <% const
                                                                                    fullStars=Math.floor(bag.ratings);
                                                                                    %>
                                                                                    <% const hasHalfStar=bag.ratings %
                                                                                        1>=
                                                                                        0.3 && bag.ratings % 1 < 0.8; %>
                                                                                            <% const emptyStars=5 -
                                                                                                fullStars - (hasHalfStar
                                                                                                ? 1 : 0); %>

                                                                                                <% for (let i=0; i <
                                                                                                    fullStars; i++) { %>
                                                                                                    <i
                                                                                                        class="fas fa-star text-sm text-yellow-400"></i>
                                                                                                    <% } %>
                                                                                                        <% if
                                                                                                            (hasHalfStar)
                                                                                                            { %>
                                                                                                            <i
                                                                                                                class="fas fa-star-half-alt text-sm text-yellow-400"></i>
                                                                                                            <% } %>
                                                                                                                <% for
                                                                                                                    (let
                                                                                                                    i=0;
                                                                                                                    i <
                                                                                                                    emptyStars;
                                                                                                                    i++)
                                                                                                                    { %>
                                                                                                                    <i
                                                                                                                        class="far fa-star text-sm text-gray-300"></i>
                                                                                                                    <% }
                                                                                                                        %>
                                                                                                                        <span
                                                                                                                            class="text-sm text-gray-300 ml-1">(
                                                                                                                            <%= bag.ratings.toFixed(1)
                                                                                                                                %>
                                                                                                                                )
                                                                                                                        </span>
                                                                            </div>
                                                                            <% } %>

                                                                                <!-- View Details Button -->
                                                                                <div class="flex flex-col space-y-2">
                                                                                    <div class="flex space-x-2">
                                                                                        <a href="/products/checkout/<%= bag.id %>"
                                                                                            class="flex-1 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition transform hover:scale-105 text-center"
                                                                                            aria-label="Shop <%= bag.productName %>">Shop
                                                                                            Now</a>
                                                                                        <!-- Cart Action -->
                                                                                        <% if (bag.stock> 0) { %>
                                                                                            <% if (bag.isInCart) { %>
                                                                                                <button
                                                                                                    class="w-10 h-10 flex items-center justify-center bg-orange-100 text-orange-600 rounded-lg cursor-not-allowed"
                                                                                                    disabled
                                                                                                    aria-label="<%= bag.productName %> already added to cart">
                                                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                        class="w-5 h-5"
                                                                                                        fill="none"
                                                                                                        viewBox="0 0 24 24"
                                                                                                        stroke="currentColor">
                                                                                                        <path
                                                                                                            stroke-linecap="round"
                                                                                                            stroke-linejoin="round"
                                                                                                            stroke-width="2"
                                                                                                            d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                                                                                    </svg>
                                                                                                </button>
                                                                                                <% } else { %>
                                                                                                    <form
                                                                                                        action="/carts/add"
                                                                                                        method="post"
                                                                                                        class="add-to-cart">
                                                                                                        <input
                                                                                                            type="hidden"
                                                                                                            name="productId"
                                                                                                            value="<%= bag.id %>" />
                                                                                                        <input
                                                                                                            type="number"
                                                                                                            name="quantity"
                                                                                                            value="1"
                                                                                                            min="1"
                                                                                                            max="<%= bag.stock %>"
                                                                                                            class="hidden"
                                                                                                            aria-label="Quantity for <%= bag.productName %>" />
                                                                                                        <button
                                                                                                            type="submit"
                                                                                                            class="w-10 h-10 flex items-center cursor-pointer justify-center bg-orange-100 hover:bg-orange-200 text-orange-600 rounded-lg transition transform hover:scale-105"
                                                                                                            aria-label="Add <%= bag.productName %> to cart">
                                                                                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                                class="w-5 h-5"
                                                                                                                fill="none"
                                                                                                                viewBox="0 0 24 24"
                                                                                                                stroke="currentColor">
                                                                                                                <path
                                                                                                                    stroke-linecap="round"
                                                                                                                    stroke-linejoin="round"
                                                                                                                    stroke-width="2"
                                                                                                                    d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                                                                                            </svg>
                                                                                                        </button>
                                                                                                    </form>
                                                                                                    <% } %>
                                                                                                        <% } else { %>
                                                                                                            <button
                                                                                                                class="w-10 h-10 flex items-center justify-center bg-orange-100 text-orange-600 rounded-lg cursor-not-allowed"
                                                                                                                disabled
                                                                                                                aria-label="<%= bag.productName %> is sold out">
                                                                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                                    class="w-5 h-5"
                                                                                                                    fill="none"
                                                                                                                    viewBox="0 0 24 24"
                                                                                                                    stroke="currentColor">
                                                                                                                    <path
                                                                                                                        stroke-linecap="round"
                                                                                                                        stroke-linejoin="round"
                                                                                                                        stroke-width="2"
                                                                                                                        d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                                                                                                </svg>
                                                                                                            </button>
                                                                                                            <% } %>
                                                                                    </div>
                                                                                    <div class="flex space-x-2">
                                                                                        <a href="/products/view/<%= bag.id %>"
                                                                                            class="flex-1 bg-gray-100 hover:bg-orange-100 text-gray-800 px-4 py-2 rounded-lg text-sm font-medium transition transform hover:scale-105 text-center"
                                                                                            aria-label="View details for <%= bag.productName %>">View
                                                                                            Details</a>
                                                                                        <!-- Wishlist Action -->
                                                                                        <% if (bag.isInWishlist) { %>
                                                                                            <!-- Already in wishlist -->
                                                                                            <button
                                                                                                class="w-10 h-10 flex items-center justify-center bg-red-100 text-red-600 rounded-lg cursor-not-allowed"
                                                                                                disabled
                                                                                                aria-label="<%= bag.productName %> already in wishlist">
                                                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                    class="w-5 h-5"
                                                                                                    fill="currentColor"
                                                                                                    viewBox="0 0 24 24">
                                                                                                    <path
                                                                                                        d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 
                                                                                                        2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 
                                                                                                        4.5 2.09C13.09 3.81 14.76 3 16.5 3 
                                                                                                        19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 
                                                                                                        11.54L12 21.35z" />
                                                                                                </svg>
                                                                                            </button>
                                                                                            <% } else { %>
                                                                                                <!-- Add to wishlist form -->
                                                                                                <form
                                                                                                    action="/wishlists/add/<%= bag._id %>"
                                                                                                    method="post">
                                                                                                    <button
                                                                                                        type="submit"
                                                                                                        class="w-10 h-10 cursor-pointer flex items-center justify-center bg-gray-100 hover:bg-red-100 text-gray-600 hover:text-red-600 rounded-lg transition transform hover:scale-105"
                                                                                                        aria-label="Add <%= bag.productName %> to wishlist">
                                                                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                            class="w-5 h-5"
                                                                                                            fill="none"
                                                                                                            viewBox="0 0 24 24"
                                                                                                            stroke="currentColor">
                                                                                                            <path
                                                                                                                stroke-linecap="round"
                                                                                                                stroke-linejoin="round"
                                                                                                                stroke-width="2"
                                                                                                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 
                                                                                                            20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 
                                                                                                            7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                                                                                                        </svg>
                                                                                                    </button>
                                                                                                </form>
                                                                                                <% } %>

                                                                                    </div>
                                                                                </div>
                                                </div>

                                    </div>
                                    <!-- Persistent Details (Small Devices Only) -->
                                    <div class="p-5 space-y-3 lg:hidden">
                                        <!-- Stock Badge -->
                                        <% if (bag.stock < 10 && bag.stock> 0) { %>
                                            <div
                                                class="absolute top-3 left-3 bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-xs">
                                                Only <%= bag.stock %> left
                                            </div>
                                            <% } else if (bag.stock <=0) { %>
                                                <div
                                                    class="absolute top-3 left-3 bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-xs">
                                                    Sold out
                                                </div>
                                                <% } %>
                                                    <div class="flex justify-between items-start relative">
                                                        <!-- Discount Tag -->
                                                        <% if (bag.discount) { %>
                                                            <div
                                                                class="absolute -top-3.5 -right-2 bg-green-200 text-green-800 px-2 rounded-full text-xs font-medium">
                                                                <%= bag.discount %>% OFF
                                                            </div>
                                                            <% } %>
                                                                <h3 id="bag-<%= bag.id %>-name"
                                                                    class="text-lg font-bold text-gray-900 line-clamp-1">
                                                                    <%= bag.productName %>
                                                                </h3>
                                                                <!-- Price -->
                                                                <div class="flex items-center space-x-1">
                                                                    <span class="text-lg font-bold text-orange-600"
                                                                        aria-label="Price <%= (bag.discount && bag.discount > 0 && bag.discount <= 100) ? Math.round((bag.price || 0) * (1 - bag.discount / 100)) : (bag.price || 0) %> rupees">
                                                                        ₹<%= (bag.discount && bag.discount> 0 &&
                                                                            bag.discount <= 100) ? Math.round((bag.price
                                                                                || 0) * (1 - bag.discount /
                                                                                100)).toLocaleString('en-IN') :
                                                                                (bag.price || 0).toLocaleString('en-IN')
                                                                                %>
                                                                    </span>
                                                                    <% if (bag.discount && bag.discount> 0 &&
                                                                        bag.discount <= 100) { %>
                                                                            <span
                                                                                class="text-sm text-gray-500 line-through"
                                                                                aria-label="Original price <%= (bag.price || 0) %> rupees">
                                                                                ₹<%= (bag.price ||
                                                                                    0).toLocaleString('en-IN') %>
                                                                            </span>
                                                                            <% } %>
                                                                </div>
                                                    </div>
                                                    <!-- Rating -->
                                                    <% if (bag.ratings && bag.ratings> 0 && bag.ratings <= 5) { %>
                                                            <div
                                                                class="flex gap-1 py-0.5 rounded-sm w-fit text-yellow-400">
                                                                <% const fullStars=Math.floor(bag.ratings); %>
                                                                    <% const hasHalfStar=bag.ratings % 1>= 0.3 &&
                                                                        bag.ratings % 1 < 0.8; %>
                                                                            <% const emptyStars=5 - fullStars -
                                                                                (hasHalfStar ? 1 : 0); %>

                                                                                <% for (let i=0; i < fullStars; i++) {
                                                                                    %>
                                                                                    <i class="fas fa-star text-xs"></i>
                                                                                    <% } %>
                                                                                        <% if (hasHalfStar) { %>
                                                                                            <i
                                                                                                class="fas fa-star-half-alt text-xs"></i>
                                                                                            <% } %>
                                                                                                <% for (let i=0; i <
                                                                                                    emptyStars; i++) {
                                                                                                    %>
                                                                                                    <i
                                                                                                        class="far fa-star text-xs text-gray-300"></i>
                                                                                                    <% } %>
                                                                                                        <span
                                                                                                            class="text-[10px] text-gray-400 font-bold text-sm">
                                                                                                            (<%= bag.ratings.toFixed(1)
                                                                                                                %>)
                                                                                                        </span>
                                                            </div>
                                                            <% } %>

                                                                <p class="text-sm text-gray-600 line-clamp-2">
                                                                    <%= bag.description %>
                                                                </p>
                                                                <div class="flex flex-col space-y-2">
                                                                    <div class="flex space-x-2">
                                                                        <a href="/products/checkout/<%= bag.id %>"
                                                                            class="flex-1 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition transform hover:scale-105 text-center"
                                                                            aria-label="Shop <%= bag.productName %>">Shop
                                                                            Now</a>
                                                                        <!-- Cart Action -->
                                                                        <% if (bag.stock> 0) { %>
                                                                            <% if (bag.isInCart) { %>
                                                                                <button
                                                                                    class="w-10 h-10 flex items-center justify-center bg-orange-100 text-orange-600 rounded-lg cursor-not-allowed"
                                                                                    disabled
                                                                                    aria-label="<%= bag.productName %> already added to cart">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                                        class="w-5 h-5" fill="none"
                                                                                        viewBox="0 0 24 24"
                                                                                        stroke="currentColor">
                                                                                        <path stroke-linecap="round"
                                                                                            stroke-linejoin="round"
                                                                                            stroke-width="2"
                                                                                            d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                                                                    </svg>
                                                                                </button>
                                                                                <% } else { %>
                                                                                    <form action="/carts/add"
                                                                                        method="post"
                                                                                        class="add-to-cart">
                                                                                        <input type="hidden"
                                                                                            name="productId"
                                                                                            value="<%= bag.id %>" />
                                                                                        <input type="number"
                                                                                            name="quantity" value="1"
                                                                                            min="1"
                                                                                            max="<%= bag.stock %>"
                                                                                            class="hidden"
                                                                                            aria-label="Quantity for <%= bag.productName %>" />
                                                                                        <button type="submit"
                                                                                            class="w-10 h-10 flex items-center cursor-pointer justify-center bg-orange-100 hover:bg-orange-200 text-orange-600 rounded-lg transition transform hover:scale-105"
                                                                                            aria-label="Add <%= bag.productName %> to cart">
                                                                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                class="w-5 h-5"
                                                                                                fill="none"
                                                                                                viewBox="0 0 24 24"
                                                                                                stroke="currentColor">
                                                                                                <path
                                                                                                    stroke-linecap="round"
                                                                                                    stroke-linejoin="round"
                                                                                                    stroke-width="2"
                                                                                                    d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                                                                            </svg>
                                                                                        </button>
                                                                                    </form>
                                                                                    <% } %>
                                                                                        <% } else { %>
                                                                                            <button
                                                                                                class="w-10 h-10 flex items-center justify-center bg-orange-100 text-orange-600 rounded-lg cursor-not-allowed"
                                                                                                disabled
                                                                                                aria-label="<%= bag.productName %> is sold out">
                                                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                                                    class="w-5 h-5"
                                                                                                    fill="none"
                                                                                                    viewBox="0 0 24 24"
                                                                                                    stroke="currentColor">
                                                                                                    <path
                                                                                                        stroke-linecap="round"
                                                                                                        stroke-linejoin="round"
                                                                                                        stroke-width="2"
                                                                                                        d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                                                                                </svg>
                                                                                            </button>
                                                                                            <% } %>
                                                                    </div>
                                                                    <div class="flex space-x-2">
                                                                        <a href="/products/view/<%= bag.id %>"
                                                                            class="flex-1 bg-gray-100 hover:bg-orange-100 text-gray-800 px-4 py-2 rounded-lg text-sm font-medium transition transform hover:scale-105 text-center"
                                                                            aria-label="View details for <%= bag.productName %>">View
                                                                            Details</a>
                                                                        <!-- Wishlist Action -->
                                                                        <% if (bag.isInWishlist) { %>
                                                                            <!-- Already in wishlist -->
                                                                            <button
                                                                                class="w-10 h-10 flex items-center justify-center bg-red-100 text-red-600 rounded-lg cursor-not-allowed"
                                                                                disabled
                                                                                aria-label="<%= bag.productName %> already in wishlist">
                                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                                    class="w-5 h-5" fill="currentColor"
                                                                                    viewBox="0 0 24 24" stroke="none">
                                                                                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 
                                                                                                2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 
                                                                                                4.5 2.09C13.09 3.81 14.76 3 16.5 3 
                                                                                                19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 
                                                                                                11.54L12 21.35z" />
                                                                                </svg>
                                                                            </button>
                                                                            <% } else { %>
                                                                                <!-- Not in wishlist: clickable -->
                                                                                <form
                                                                                    action="/wishlists/add/<%= bag._id %>"
                                                                                    method="post">
                                                                                    <button type="submit"
                                                                                        class="w-10 h-10 flex items-center justify-center bg-gray-100 hover:bg-orange-100 rounded-lg transition transform hover:scale-105"
                                                                                        aria-label="Add <%= bag.productName %> to wishlist">
                                                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                                                            class="w-5 h-5 text-gray-600"
                                                                                            fill="none"
                                                                                            viewBox="0 0 24 24"
                                                                                            stroke="currentColor">
                                                                                            <path stroke-linecap="round"
                                                                                                stroke-linejoin="round"
                                                                                                stroke-width="2"
                                                                                                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 
                                                                                                        20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 
                                                                                                        7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                                                                                        </svg>
                                                                                    </button>
                                                                                </form>
                                                                                <% } %>

                                                                    </div>
                                                                </div>
                                    </div>
                                </div>
                                <% }); %>
                        </div>
                    </section>

                    <!-- Review Section -->
                    <!-- only render when reviews available -->
                    <% if (reviews.length !==0) { %>
                        <section id="reviews"
                            class=" max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 bg-white/70 mb-6 rounded-2xl"
                            role="region" aria-label="Customer reviews">
                            <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-12 text-center">
                                What
                                Our
                                Customers
                                Say
                            </h2>
                            <div class="overflow-hidden relative">
                                <div id="reviews-container" class="flex flex-nowrap gap-4 pb-4 animate-scroll">
                                    <% reviews.forEach(function(review, index) { %>
                                        <article
                                            class="group bg-white border-l-4 border-orange-300 rounded-xl shadow-md p-6 transition-all duration-300 hover:shadow-xl hover:scale-105 flex-shrink-0 w-80 sm:w-96"
                                            role="article" aria-labelledby="review-<%= index %>-author">
                                            <div class="flex items-center space-x-4">
                                                <div class="flex-shrink-0">
                                                    <img src="<%= review.profilePic || '/images/default-profile.jpg' %>"
                                                        alt="Profile picture of <%= review.author %>"
                                                        class="w-12 h-12 rounded-full border-2 border-orange-300 object-cover group-hover:shadow-md transition-all duration-300"
                                                        loading="lazy" aria-hidden="true" />
                                                </div>
                                                <div class="flex-1">
                                                    <div class="flex items-center mb-3">
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                            class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                            viewBox="0 0 20 20">
                                                            <path
                                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                        </svg>
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                            class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                            viewBox="0 0 20 20">
                                                            <path
                                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                        </svg>
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                            class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                            viewBox="0 0 20 20">
                                                            <path
                                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                        </svg>
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                            class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                            viewBox="0 0 20 20">
                                                            <path
                                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                        </svg>
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                            class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                            viewBox="0 0 20 20">
                                                            <path
                                                                d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                        </svg>
                                                        <span class="ml-2 text-xs text-gray-600">
                                                            <%= review.num %>
                                                        </span>
                                                    </div>
                                                    <p class="text-base text-gray-700 mb-4 line-clamp-3">
                                                        "
                                                        <%= review.text %>
                                                            "
                                                    </p>
                                                    <p id="review-<%= index %>-author"
                                                        class="text-sm font-bold text-gray-900">–
                                                        <%= review.author %>
                                                    </p>
                                                </div>
                                            </div>
                                        </article>
                                        <% }); %>
                                            <!-- Duplicate reviews for seamless looping -->
                                            <% reviews.forEach(function(review, index) { %>
                                                <article
                                                    class="group bg-white border-l-4 border-orange-300 rounded-xl shadow-md p-6 transition-all duration-300 hover:shadow-xl hover:scale-105 flex-shrink-0 w-80 sm:w-96"
                                                    role="article"
                                                    aria-labelledby="review-duplicate-<%= index %>-author">
                                                    <div class="flex items-center space-x-4">
                                                        <div class="flex-shrink-0">
                                                            <img src="<%= review.profilePic || '/images/default-profile.jpg' %>"
                                                                alt="Profile picture of <%= review.author %>"
                                                                class="w-12 h-12 rounded-full border-2 border-orange-300 object-cover group-hover:shadow-md transition-all duration-300"
                                                                loading="lazy" aria-hidden="true" />
                                                        </div>
                                                        <div class="flex-1">
                                                            <div class="flex items-center mb-3">
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                                    viewBox="0 0 20 20">
                                                                    <path
                                                                        d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                                </svg>
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                                    viewBox="0 0 20 20">
                                                                    <path
                                                                        d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                                </svg>
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                                    viewBox="0 0 20 20">
                                                                    <path
                                                                        d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                                </svg>
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                                    viewBox="0 0 20 20">
                                                                    <path
                                                                        d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                                </svg>
                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                    class="w-5 h-5 text-yellow-400" fill="currentColor"
                                                                    viewBox="0 0 20 20">
                                                                    <path
                                                                        d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3 .921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784 .57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81 .588-1.81h3.461a1 1 0 00 .951-.69l1.07-3.292z" />
                                                                </svg>
                                                                <span class="ml-2 text-xs text-gray-600">(5.0)</span>
                                                            </div>
                                                            <p class="text-base text-gray-700 mb-4 line-clamp-3">
                                                                "
                                                                <%= review.text %>"
                                                            </p>
                                                            <p id="review-duplicate-<%= index %>-author"
                                                                class="text-sm font-bold text-gray-900">
                                                                –
                                                                <%= review.author %>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </article>
                                                <% }); %>
                                </div>
                            </div>
                        </section>
                        <% }%>

                            <!-- Features Section -->
                            <section id="features" class="py-15 bg-white/50 backdrop-blur-sm">
                                <div class="max-w-7xl mx-auto px-6">
                                    <div class="text-center mb-20">
                                        <h2 class="text-4xl font-bold text-gray-900 mb-4">Crafted
                                            for
                                            Excellence
                                        </h2>
                                        <p class="text-xl text-gray-600 max-w-2xl mx-auto">Premium
                                            features
                                            that
                                            redefine
                                            your
                                            experience
                                        </p>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                                        <div class="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition">
                                            <div
                                                class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center mb-6">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600"
                                                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                </svg>
                                            </div>
                                            <h3 class="text-xl font-bold mb-3">Fast Shipping</h3>
                                            <p class="text-gray-600">Get your order delivered within
                                                2-3
                                                business
                                                days with
                                                our
                                                premium
                                                shipping partners.</p>
                                        </div>
                                        <div class="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition">
                                            <div
                                                class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center mb-6">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600"
                                                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M12 15l8-8m0 0l-8-8m8 8H4" />
                                                </svg>
                                            </div>
                                            <h3 class="text-xl font-bold mb-3">Easy Returns</h3>
                                            <p class="text-gray-600">30-day hassle-free returns with
                                                our
                                                simple
                                                return
                                                process and
                                                prepaid
                                                labels.</p>
                                        </div>
                                        <div class="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition">
                                            <div
                                                class="w-14 h-14 bg-indigo-100 rounded-xl flex items-center justify-center mb-6">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600"
                                                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                                                </svg>
                                            </div>
                                            <h3 class="text-xl font-bold mb-3">Quality Guarantee
                                            </h3>
                                            <p class="text-gray-600">Crafted with premium materials,
                                                our
                                                bags
                                                come
                                                with a
                                                lifetime
                                                quality
                                                assurance.</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                </main>
                <!-- Footer -->
                <%- include('partials/footer') %>

                    <!-- JavaScripts -->
                    <!-- Pass bags data to client-side -->
                    <script>
                        // Serialize bags data for client-side use
                        window.bagsData = ` <%- JSON.stringify(bags.slice(0, 5)) %>`;
                    </script>

                    <!-- Import and initialize the carousel module -->
                    <script type="module">
                        import initCarousel from '/javascripts/carousel.js';

                        // Initialize the carousel after DOM is loaded
                        document.addEventListener('DOMContentLoaded', () => {
                            const stopAutoScroll = initCarousel(window.bagsData);

                            // Clean up on page unload to prevent multiple intervals
                            window.addEventListener('beforeunload', stopAutoScroll);
                        });
                    </script>
                    <script src="/javascripts/searchAndMenuToggle.js"></script>
                    <script src="/javascripts/profileToggle.js"></script>
                    <script src="/javascripts/flashMessage.js"></script>
    </body>

</html>